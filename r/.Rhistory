knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(visdat)
df_all <- readr::read_csv("final_project_train.csv", col_names = TRUE)
df_all <- readr::read_csv("final_project_train.csv", col_names = TRUE)
df_all %>% glimpse()
visdat::vis_miss(df_all)
df_all %>% purrr::map_dbl(n_distinct)
df_all %>% count(region)
df_all %>% ggplot(mapping = aes(x = region)) + geom_bar()
df_all %>% count(region)
df_all %>% ggplot(mapping = aes(x = region)) + geom_bar()
df_all %>% count(customer)
df_all %>% ggplot(mapping = aes(x = customer)) + geom_bar()
df_all %>% count(outcome)
df_all %>% ggplot(mapping = aes(x = outcome)) + geom_bar()
df_all %>% count(outcome)
df_all %>% ggplot(mapping = aes(x = outcome)) + geom_bar()
mean(df_all$outcome == "event")
df_all %>%
select_all(starts_with("x"), response)
df_all %>%
select_all(starts_with("x"), response)
df_all %>%
select_all(starts_with("x"))
df_all %>%
select(all_of(starts_with("x")))
df_all %>%
select(all_of(starts_with("x"))) %>%
bind_cols(response)
df_all %>%
select(all_of(starts_with("xb_")))
df_all %>%
select(all_of(starts_with("xb_"))) %>%
bind_cols(select(df_all$rowid))
df_all %>%
select(all_of(starts_with("xb_"
df_all %>%
df_all %>%
select(rowid, xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response)
df_all %>%
select(rowid, xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response) %>%
tibble::rowid_to_column()
df_all %>%
select(rowid, xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response) %>%
pivot_longer(!c("rowid"))
df_all %>%
select(rowid, xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response)
df_all %>%
select(xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid"))
df_all %>%
select(xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xb_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xn_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xa_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xw_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xs_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xb_"))) %>%
summary()
df_all %>%
select(all_of(starts_with("xb_"))) %>%
summary()
df_all %>%
select(all_of(starts_with("xn_"))) %>%
summary()
df_all %>%
select(all_of(starts_with("xa_"))) %>%
summary()
df_all %>%
select(all_of(starts_with("xa_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xs_"))) %>%
summary()
df_all %>%
select(all_of(starts_with("xs_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xw_"))) %>%
summary()
df_all %>%
select(all_of(starts_with("xw_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(response) %>%
summary()
df_all %>%
select(response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(-rowid, customer, outcome)
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid", "region")) %>%
mutate(input_id = as.integer( stringr::str_extract(name, "\\d+") )) %>%
ggplot(mapping = aes(x = input_id, y = value)) +
geom_boxplot(mapping = aes(group = interaction(input_id, region),
fill = region,
color = region),
alpha = 0.25) +
ggthemes::scale_color_colorblind() +
ggthemes::scale_fill_colorblind() +
theme(legend.position = "top")
df_all %>%
select(-rowid, customer, outcome) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid", "region")) %>%
mutate(input_id = as.integer( stringr::str_extract(name, "\\d+") )) %>%
ggplot(mapping = aes(x = input_id, y = value)) +
geom_boxplot(mapping = aes(group = interaction(input_id, region),
fill = region,
color = region),
alpha = 0.25) +
ggthemes::scale_color_colorblind() +
ggthemes::scale_fill_colorblind() +
theme(legend.position = "top")
df_all %>%
select(-rowid, -customer, -outcome) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid", "region")) %>%
mutate(input_id = as.integer( stringr::str_extract(name, "\\d+") )) %>%
ggplot(mapping = aes(x = input_id, y = value)) +
geom_boxplot(mapping = aes(group = interaction(input_id, region),
fill = region,
color = region),
alpha = 0.25) +
ggthemes::scale_color_colorblind() +
ggthemes::scale_fill_colorblind() +
theme(legend.position = "top")
df_all %>%
select(-rowid, -region, -outcome) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid", "customer")) %>%
mutate(input_id = as.integer( stringr::str_extract(name, "\\d+") )) %>%
ggplot(mapping = aes(x = input_id, y = value)) +
geom_boxplot(mapping = aes(group = interaction(input_id, customer),
fill = customer,
color = customer),
alpha = 0.25) +
ggthemes::scale_color_colorblind() +
ggthemes::scale_fill_colorblind() +
theme(legend.position = "top")
df_all %>%
select(-rowid, -region, -customer) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid", "outcome")) %>%
mutate(input_id = as.integer( stringr::str_extract(name, "\\d+") )) %>%
ggplot(mapping = aes(x = input_id, y = value)) +
geom_boxplot(mapping = aes(group = interaction(input_id, outcome),
fill = outcome,
color = outcome),
alpha = 0.25) +
ggthemes::scale_color_colorblind() +
ggthemes::scale_fill_colorblind() +
theme(legend.position = "top")
df_all %>%
select(-rowid, -region, -customer, -outcome) %>%
cor() %>%
corrplot::corrplot(method = 'square', type = 'upper')
df_all %>%
select(all_of(starts_with("x"))) %>%
cor() %>%
corrplot::corrplot(method = 'square', type = 'upper')
df_all %>%
select(all_of(starts_with("x"))) %>%
cor() %>%
corrplot::corrplot(method = 'square', type = 'upper',
order = 'hclust', hclust.method = 'ward.D2')
df_all %>%
select(response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
geom_vline(xintercept = quantile(df_all$reponse),
color = 'red', size = 1.2, linetype = 'dashed') +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
geom_vline(xintercept = quantile(df_all$response),
color = 'red', size = 1.2, linetype = 'dashed') +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value)) +
geom_histogram(bins = 35) +
geom_vline(xintercept = quantile(df_all$response),
color = 'red', size = 1, linetype = 'dashed') +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value, y = response)) +
geom_rug(alpha = 0.2) +
geom_histogram(bins = 35) +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(xb_01, xb_02, xb_03, xb_04, xb_05, xb_06, xb_07, xb_08, response) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid"))
# to set up a geom_smooth-like figure with response on the y-axis,
# and different color for different xb_ features
df_all %>%
select(all_of(starts_with("xb_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value, y = df_all$response)) +
geom_line() +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
# to set up a geom_smooth-like figure with response on the y-axis,
# and different color for different xb_ features
df_all %>%
ggplot(mapping = aes(x = xb_01, y = response)) +
geom_line()
# to set up a geom_smooth-like figure with response on the y-axis,
# and different color for different xb_ features
df_all %>%
ggplot(mapping = aes(x = xb_02, y = response)) +
geom_line()
# to set up a geom_smooth-like figure with response on the y-axis,
# and different color for different xb_ features
df_all %>%
ggplot(mapping = aes(x = xb_02, y = response)) +
geom_smooth(method = "lm")
# to set up a geom_smooth-like figure with response on the y-axis,
# and different color for different xb_ features
df_all %>%
ggplot(mapping = aes(x = xb_02, y = response)) +
geom_point()
# to set up a geom_smooth-like figure with response on the y-axis,
# and different color for different xb_ features
df_all %>%
select(all_of(starts_with("xb_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid")) %>%
ggplot(mapping = aes(x = value, y = df_all$response)) +
geom_point() +
facet_wrap(~ name, scales = "free") +
theme(axis.text.y = element_blank())
df_all %>%
select(all_of(starts_with("xb_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid"))
df_all %>%
select(all_of(starts_with("xb_"))) %>%
tibble::rowid_to_column()
df_all %>%
select(all_of(starts_with("xb_"))) %>%
tibble::rowid_to_column() %>%
pivot_longer(!c("rowid"))
df_all %>%
ggplot(mapping = aes(x = xb_01, y = response)) +
geom_point()
